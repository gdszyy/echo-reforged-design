# 世界变迁系统设计文档

> **文档版本**: 0.1 (草案)
> **最后更新**: 2025-01-06

## 概述

《Echo Reforged》的世界不是静态的背景板，而是一个**活的、会演化的生态系统**。世界变迁系统是游戏的核心支柱之一，它不仅提供探索的舞台，更与战斗系统、Build 系统深度联动。

### 核心理念

> **世界即战场，战场即世界。**

战斗场地是世界场景的一部分，而非独立的"战斗副本"。玩家在世界地图上的位置、所处地块的属性，都会直接影响战斗的环境和规则。

---

## 一、世界结构：四层系统

世界由四个相互影响的层级构成（继承自 World Morphing Simulator 的概念验证）：

| 层级 | 名称 | 核心内容 | 演化驱动 |
| :--- | :--- | :--- | :--- |
| **1** | 地幔层 (Mantle) | 能量分布、地形基础 | 能量流动、地质活动 |
| **2** | 晶体层 (Crystal) | α/β 晶石分布 | 能量浓度、玩家干预 |
| **3** | 气候层 (Climate) | 温度、湿度、天气 | 晶体状态、季节循环 |
| **4** | 生物层 (Biome) | 生物分布、聚落位置 | 资源丰度、气候条件 |

---

## 二、晶石系统：世界的血脉

晶石是世界变迁的核心驱动力，也是玩家与世界互动的主要媒介。

### 2.1 晶石类型

| 晶石类型 | 特性 | 对世界的影响 | 对玩家的意义 |
| :--- | :--- | :--- | :--- |
| **α 晶石 (Alpha)** | 高能、不稳定、具有侵蚀性 | 扩散并侵蚀周围地块，威胁生物聚落 | 危险区域，但可能蕴含稀有资源 |
| **β 晶石 (Beta)** | 稳定、可开采、具有封印性 | 占据地块位置，阻止 α 晶石生成 | **核心资源**，用于升级和制作 |

### 2.2 晶石博弈：玩家的两难抉择

**β 晶石的双重角色**：

β 晶石既是玩家渴望的资源，也是世界稳定的守护者。这创造了一个核心的**道德/策略困境**：

```
┌─────────────────────────────────────────────────────────┐
│                    β 晶石地块                            │
│                                                         │
│   [稳定状态]                                             │
│   - β 晶石占据地块，阻止 α 晶石生成                       │
│   - 地幔能量被封印，地块安全                              │
│   - 附近可能存在繁荣的人类聚落                            │
│                                                         │
│                    ▼ 玩家开采 β 晶石                     │
│                                                         │
│   [失衡状态]                                             │
│   - β 晶石被移除，封印解除                               │
│   - 地幔能量释放，α 晶石开始大量繁衍                      │
│   - α 晶石可能侵蚀并摧毁附近的人类聚落                    │
│   - 玩家可能失去据点，流离失所                            │
└─────────────────────────────────────────────────────────┘
```

**设计目标**：让玩家的每一次资源开采都不是"免费的午餐"，而是需要权衡短期收益（获得资源）和长期风险（世界失衡）的决策。

---

## 三、生物聚落：世界的居民

### 3.1 聚落生成

世界变迁系统会根据地块条件**自然生成**生物聚落：

- **人类聚落**: 倾向于在 β 晶石丰富、气候温和的区域生成
- **敌对生物巢穴**: 倾向于在 α 晶石活跃、能量充沛的区域生成

玩家在世界中遇到的**友好 NPC** 和**敌人**，都来源于这些自然生成的聚落，而非预设的脚本。

### 3.2 聚落兴衰与迁徙

聚落不是静态的，它们会根据世界变迁的结果而**兴衰和迁徙**：

| 事件 | 触发条件 | 结果 |
| :--- | :--- | :--- |
| **聚落繁荣** | 周围资源丰富，无 α 晶石威胁 | 聚落规模扩大，提供更多服务/商品 |
| **聚落衰落** | 资源枯竭或 α 晶石逼近 | 聚落规模缩小，NPC 可能离开 |
| **聚落迁徙** | 原址不再宜居 | 聚落整体迁移到新的安全区域 |
| **聚落毁灭** | α 晶石侵蚀或敌对势力攻击 | 聚落消失，玩家失去该据点 |

### 3.3 玩家与聚落的关系

玩家可以与人类聚落建立关系：

- **据点**: 玩家可以将某个聚落设为据点，获得存储、休息、交易等服务。
- **声望**: 玩家的行为（帮助防御、提供资源、或因开采导致灾难）会影响与聚落的声望。
- **后果**: 如果玩家的开采行为导致聚落被 α 晶石摧毁，玩家将失去该据点，并可能在其他聚落中声名狼藉。

---

## 四、战斗场地与世界联动

### 4.1 地块属性影响战斗

当玩家在特定地块上触发战斗时，该地块的属性会直接影响战斗场景：

| 地块属性 | 战斗场景影响 |
| :--- | :--- |
| **α 晶石活跃区** | 场景中出现不稳定的能量节点，可被击中引发爆炸；敌人可能获得狂暴增益 |
| **β 晶石富集区** | 场景中出现可开采的晶石，战斗中可获得少量资源；地形更加稳固 |
| **高温地块** | 火属性伤害增强；冰属性效果减弱；可能出现岩浆地形 |
| **低温地块** | 冰属性伤害增强；火属性效果减弱；可能出现冰面（影响移动） |
| **人类聚落附近** | 可能有友军 NPC 协助；战斗失败可能导致聚落受损 |

### 4.2 剧情场地：固定的特殊战斗

在世界地图的特定位置，会设置**剧情场地**。这些场地拥有预设的特殊元素：

- **场景敌人**: 与该地点叙事相关的特殊敌人（如守护古代遗迹的石像鬼）
- **场景物品**: 可互动的环境物品（如可推倒的石柱、可点燃的油桶）
- **场景机关**: 需要解谜或特定条件才能触发的机关

---

## 五、玩家影响世界：蝴蝶效应

玩家的行为会对世界产生持久的影响，这些影响会通过世界变迁系统传播和放大。

### 5.1 影响类型

| 玩家行为 | 直接影响 | 潜在连锁反应 |
| :--- | :--- | :--- |
| **开采 β 晶石** | 获得资源；移除地块封印 | α 晶石繁衍 → 聚落受威胁 → 失去据点 |
| **清除 α 晶石** | 净化地块；获得特殊材料 | 地块稳定 → 可能吸引新聚落 → 新的交易伙伴 |
| **帮助聚落防御** | 提升声望；获得奖励 | 聚落繁荣 → 提供更好的服务 |
| **忽视聚落求助** | 无直接影响 | 聚落衰落/毁灭 → 失去服务 → 其他聚落声望下降 |

### 5.2 世界状态的可视化

玩家需要能够感知世界的变化。可以通过以下方式呈现：

- **世界地图颜色/图标变化**: α 晶石区域显示为危险的红色脉动
- **NPC 对话**: 聚落 NPC 会谈论世界的变化（"最近北边的晶石越来越活跃了..."）
- **环境叙事**: 探索时发现被 α 晶石侵蚀的废墟，暗示曾经的聚落

---

## 六、开放问题与下一步

1. **演化频率**: 世界变迁多久迭代一次？是实时的还是基于玩家行动的？
2. **可逆性**: 玩家能否"修复"被 α 晶石侵蚀的区域？代价是什么？
3. **信息透明度**: 玩家能否预测开采的后果？还是只能事后发现？
4. **平衡**: 如何确保世界不会因为玩家的行为而变得"无法游玩"？

