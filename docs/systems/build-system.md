# 复合 Build 系统设计文档

> **文档版本**: 0.2 (修订版)
> **最后更新**: 2025-01-06

## 概述

《Echo Reforged》的 Build 系统采用**复合架构**，融合了两种经典的 Build 设计范式：

| 范式 | 特征 | 玩家体验 |
| :--- | :--- | :--- |
| **圆桌类型 (Round Table)** | 有限权重、机会成本、零和博弈 | 每一次选择都意味着放弃其他可能性，强调取舍 |
| **瀑布类型 (Waterfall)** | 累积叠加、成长可见、正反馈循环 | 越玩越强，Build 的威力随时间/投入增长 |

本游戏的 Build 系统由三个相互关联的子系统组成：

1. **钉盘养成系统** (圆桌类型)
2. **子弹编程系统** (瀑布类型)
3. **符文填字谜系统** (圆桌 & 瀑布混合)

---

## 一、钉盘养成系统

### 1.1 核心概念

每个**发射器**都拥有一个专属的**钉盘 (Peg Board)**。钉盘上分布着若干**钉子插槽 (Peg Slots)**，玩家需要在有限的插槽中选择安装哪些钉子。

当弹珠在钉盘中弹跳并撞击钉子时，会根据钉子的类型获得对应的**属性层数**，这些属性层数将被应用于最终射出的**子弹**。

### 1.2 设计要点

**圆桌特性体现**：

- **插槽有限**: 钉盘的插槽数量是固定的（或通过升级缓慢增加），玩家无法安装所有想要的钉子。
- **位置策略**: 钉子的位置影响弹珠撞击它的概率。核心位置的钉子更容易被触发，但数量稀少。
- **互斥钉子**: 部分高级钉子可能存在互斥关系（如"火焰钉"和"冰霜钉"不能同时安装在相邻插槽）。

### 1.3 钉子的获取与制作

钉子的核心来源与世界探索和战斗紧密相连，形成一个完整的资源循环。

1.  **探索与发现**：玩家在世界地图上探索，会发现不同属性的地块（如火山区、冰川区）。
2.  **战斗中开采**：在这些特定地块上进行战斗时，战斗场景中会刷新出可被攻击的 **β 晶石矿**。
3.  **获取精华**：玩家用子弹攻击这些矿石，会使其破碎并掉落：
    *   **β 晶石碎片**：游戏的基础货币。
    *   **精华晶石** (概率掉落)：与地块属性对应的稀有材料，如"火焰精华"、"冰霜精华"。
4.  **制作成钉**: 回到据点后，玩家可以将获得的 **精华晶石** 制作成对应属性的 **钉子** 并安装在钉盘上。

这个设计将资源获取、战斗和 Build 构建深度绑定，鼓励玩家为了特定的钉子去探索和挑战不同区域。

### 1.4 发射器差异化设计

不同类型的发射器是玩家 Build 的起点和基石。为了提供丰富的策略选择，发射器之间的差异化通过以下几个维度实现，而非简单地改变钉盘的大小和形状。

**1. 异形钉盘 (Irregular Pegboards)**

- **设计理念**: 钉盘的布局遵循"弹珠台"的设计逻辑，形状不规则，充满挑战和机遇。
- **策略点**: 某些高价值的插槽可能位于难以触及的角落，需要玩家通过特定的弹射技巧或特殊的弹珠才能稳定触发，这本身就是一种玩法。

**2. 特殊插槽 (Special Slots)**

- **概念**: 钉盘上会存在少量拥有特殊效果的插槽。
- **示例**:
    - **增幅槽 (Amplifier Slot)**: 放入此槽的钉子，其效果x1.5倍。
    - **复制槽 (Duplication Slot)**: 放入此槽的钉子，在弹珠每次离开钉盘时有概率触发一次其效果。
    - **元素槽 (Elemental Slot)**: 只能放入特定属性的钉子，但会提供额外加成。

**3. 预设钉子 (Preset Pegs)**

- **概念**: 高级或稀有的发射器会自带一个或多个**不可移除**的预设钉子，这构成了该发射器的核心特性。
- **示例**:
    - **"过载核心"发射器**: 自带一个位于中心、不可移除的"连锁闪电"钉子，定义了其以电系为核心的玩法。
    - **"熔岩之心"发射器**: 钉盘底部预设一排"热能钉"，弹珠每次经过都会增加火属性层数，鼓励玩家采取"贴底反弹"的策略。

**4. 绑定的符文格 (Bound Rune Grid)**

- **概念**: 每个发射器都拥有一个固定大小和形状的符文格。这是发射器最重要的特性之一。
- **示例**:
    - **"学者的手稿"发射器**: 可能拥有一个较大的 5x5 方形符文格，适合组合复杂的长词组，但钉盘可能较弱。
    - **"狂战士的图腾"发射器**: 可能只有一个 2x3 的小型符文格，限制了被动能力，但其钉盘和自带遗物效果可能非常强大，鼓励玩家走纯粹的物理路线。

**5. 自带遗物效果 (Innate Relic Effects)**

- **概念**: 发射器本身就拥有一个被动效果，独立于钉盘系统之外。
- **示例**:
    - **"工匠的杰作"**: 每次制作钉子时，有 10% 概率不消耗精华晶石。
    - **"时空扭曲者"**: 每天第一次战斗，可以免费重置一次钉盘布局。
    - **"拾荒者"**: 战斗中击碎 β 晶石矿时，额外掉落 15% 的碎片。

### 1.5 钉子类型初步构想

| 精华来源 | 制作出的钉子类型 | 效果 | 设计定位 |
| :--- | :--- | :--- | :--- |
| 火焰/冰霜/雷电精华 | **属性钉** | 撞击时为子弹添加对应元素属性层数 | 基础构建块 |
| 坚韧/锐利/弹射精华 | **强化钉** | 撞击时提升子弹的基础伤害/穿透/反弹次数 | 数值增强 |
| 幸运精华 | **触发钉** | 撞击时有概率触发特殊效果 | 高级策略 |
| 连锁精华 | **连锁钉** | 撞击后会"激活"相邻的钉子，产生连锁效果 | 高级策略 |

---

## 二、子弹编程系统

### 2.1 核心理念：属性层与子弹行为

子弹编程系统是构筑的“输出端”，它将从钉盘系统获得的抽象“属性层数”转化为具体、多样且充满策略性的子弹行为。其核心在于不同属性之间的**组合与联动**，创造出指数级增长的战斗可能性。

根据用户最新反馈及对原 Echo 项目代码的分析，属性系统将进行重构，取消 `Homing` 和 `Mark` 属性，并深化 `Laser` 和 `Nested` 的设计。

### 2.2 物理属性 (Physical Attributes)

物理属性决定了子弹的基础运动方式和交互逻辑，它们遵循一套基于“层数消耗”的精确规则。

#### 2.2.1 核心物理属性

这三者是构筑的基石，遵循精确的层数消耗规则。

| 属性 | 效果 | 交互规则 |
| :--- | :--- | :--- |
| **穿透 (Pierce)** | 拥有 N 层穿透的子弹，可以穿透 N 个敌人。 | 每次穿透消耗1层。与反弹共存时，优先消耗穿透。 |
| **反弹 (Bounce)** | 拥有 N 层反弹的子弹，在穿透耗尽后，击中敌人可继续反弹 N 次。 | 撞墙不消耗层数。 |
| **散射 (Scatter)** | 击中敌人时，有概率分裂成多个子弹丸。 | 每层提供 50% 分裂概率，可叠加。分裂出的子弹按比例继承母体属性。 |

#### 2.2.2 高级物理属性

高级属性引入了全新的攻击范式，是实现复杂战术的关键。

| 属性 | 效果描述 | 详细机制与联动 |
| :--- | :--- | :--- |
| **爆炸 (Explosion)** | 子弹在消失或击中敌人时，产生一次范围伤害。 | - **范围**: 爆炸范围受 `Explosion` 层数影响。<br>- **伤害**: 爆炸伤害基于子弹的基础伤害。<br>- **联动**: 可与元素属性结合，形成火焰爆炸、冰霜爆炸等。 |
| **激光 (Laser)** | **[重构]** 子弹变为一道即时命中的光束，绕过常规弹道物理。 | - **长度 (Length)**: 由 `Pierce` (穿透) 层数决定。层数越高，激光越长，能打到更远的敌人。<br>- **粗细 (Thickness)**: 由 `Laser` (激光) 层数决定。层数越高，激光越粗，更容易命中多个敌人。<br>- **反射 (Reflection)**: 由 `Bounce` (反弹) 层数决定。激光击中墙壁或特殊反射面时，可以反射 N 次。 |
| **母体/套娃 (Progenitor/Nested)** | **[重构]** 核心设计变更，借鉴了原子母剑系统的“子弹编程”思想。子弹本身成为一个“母体”，在满足特定条件时，会**释放**一个或多个预设的、完全独立的**子代子弹**。 | - **编程核心**: 母体子弹的价值在于其“装载”的子代。子代子弹的属性组合**不一定**与母体相同，可以在制作或获取时预先“编程”。<br>- **触发条件**: 释放子代的条件多样，如：首次击中敌人、飞行距离达到阈值、被特定类型的钉子触发等。<br>- **与散射的裂变反应**: 这是最具潜力的组合。当一个携带 `Scatter` 属性的母体子弹击中敌人时：<br>  1. 母体自身进行 `Scatter` 分裂，产生多个继承其“母体”属性的**新母体**。<br>  2. 同时，母体触发自身效果，释放其装载的子代子弹。<br>  3. 如果子代子弹本身也带有 `Scatter` 或 `Nested` 属性，将引发指数级的“子弹裂变”反应，实现全屏火力覆盖。 |

### 2.3 元素属性 (Elemental Attributes)

元素交互的核心是一个动态的**温度系统**。所有敌人都拥有一个“温度”值，火属性为其升温，冰属性为其降温，从而触发各种强大的连锁反应。

### 2.3 核心元素系统：温度机制

元素交互的核心是一个动态的**温度系统**。所有敌人都拥有一个"温度"值，火属性为其升温，冰属性为其降温，从而触发各种强大的连锁反应。

#### A. 火属性机制 (Pyro Mechanics)

火属性的核心是热量的积累与爆发。

| 温度阈值 | 效果 |
| :--- | :--- |
| **> 34°C** | 火属性攻击造成额外伤害。 |
| **> 100°C** | 敌人进入**燃烧**状态，每回合受到基于超出部分（温度-100）的持续伤害（DoT）。若敌人在燃烧状态下死亡，会引发**尸爆**，对周围敌人造成基于其最大生命值的伤害，并使其温度上升。 |
| **> 300°C** | 火属性伤害有**概率**触发一次**火焰爆炸**，造成大量伤害并消耗固定比例的当前热量（用于平衡过高热量）。 |
| **> 600°C** | **火焰爆炸**必定触发。 |

#### B. 冰属性机制 (Cryo Mechanics)

冰属性的核心是温度的降低与控制。

| 温度阈值 | 效果 |
| :--- | :--- |
| **< 0°C** | 敌人每回合行动前有**概率**被**冻结**一回合。 |
| **< -100°C** | 敌人必定被**冻结**。 |
| **冻结状态** | - 敌人无法行动一回合。<br>- 之后解冻，其负温度值**减半**（如-100°C变为-50°C），以避免无限控制。<br>- Boss每次从冰冻中恢复都会获得"冰冻耐受"，降低后续被冰冻的概率。<br>- 冻结的敌人会受到基于其负温度值的**伤害加深**效果。 |

#### C. 电属性机制 (Electro Mechanics)

电属性是一个独特的"反应产物"，无法直接获得，它的出现是冰火碰撞的证明。

- **获取方式**: 当一个**冰属性**的子弹获得了**火属性**（反之亦然），它不会成为冰火共存的子弹，而是会**质变为电属性**。
- **核心效果：闪电链**
    - 默认有 **20%** 概率从当前目标弹跳至一个附近的敌人，并有概率继续弹跳。
    - **与冰联动**: 敌人温度越低，闪电链的触发概率越高。在 **-100°C** 时，必定触发。
    - **与火联动**: 被闪电链击中的敌人，其温度会提升（提升量由闪电层数和弹跳次数决定）。
    - **伤害标度**: 在低"闪电层数"时，弹跳次数越多，伤害越衰减；在高"闪电层数"时，弹跳次数越多，伤害越高。

---

## 三、符文填字谜系统

### 3.1 核心概念

符文系统是一个**空间解谜 + Build 构建**的混合系统。每个**发射器**都自带一个独一无二的**符文格 (Rune Grid)**，玩家需要将获得的**符文 (Runes)** 填入格子中。

当符文在横向或纵向上组成特定的**符文词组 (Rune Words)** 时，会激活对应的**被动效果**（类似原 Echo 项目中的遗物效果）。

### 3.2 设计要点

**圆桌特性体现**：

- **格子与发射器绑定**: 符文格的大小和形状由其所属的发射器决定，是发射器核心特性的一部分。玩家无法自由扩展，只能通过更换发射器来获得不同的构筑空间。
- **空间冲突**: 一个格子只能放一个符文，放置新符文可能破坏已有的词组。

**瀑布特性体现**：

- **词组叠加**: 可以同时激活多个符文词组，效果叠加。
- **高级词组**: 更长的词组（如四字词组）效果更强，但更难组成。

### 3.3 符文词组示例

| 词组 | 组成符文 | 激活效果 |
| :--- | :--- | :--- |
| **烈焰** | 火 + 焰 | 火属性伤害 +20% |
| **寒冰** | 寒 + 冰 | 冰冻持续时间 +1秒 |
| **雷霆万钧** | 雷 + 霆 + 万 + 钧 | 电属性攻击有 15% 概率造成双倍伤害 |
| **生生不息** | 生 + 生 + 不 + 息 | 每回合恢复 1% 最大生命值 |

### 3.4 符文的获取：古代石板解谜

符文的获取并非通过简单的战斗掉落，而是通过一个集引导、解谜和局外成长于一体的"古代石板"系统。

**1. 发现石板 (Discovering Steles)**

- 在世界的特定遗迹、隐藏区域或高难度挑战的终点，玩家可以发现"古代石板"。
- 石板上刻有一个或多个残缺的符文词组，部分符文清晰可见，部分则为空缺的格子。

**2. 解谜与获取 (Solving and Acquiring)**

- 玩家需要用自己**已经学会**的符文填入石板的空缺格子中。
- 当所有空缺被正确填充，成功复原了石板上所有的符文词组后，谜题解开。
- 作为奖励，玩家将**永久学会**制作该石板上所有未知符文的方法。这些新学会的符文会加入玩家的"知识库"，可以在据点中制作和使用。

**3. 成长循环 (The Growth Loop)**

这个机制创造了一个强大的成长与探索循环：

- **初遇与引导**: 玩家早期可能发现一个复杂的石板，但因为缺少必要的符文而无法解开。这个石板成为了一个长期的探索目标，并向玩家展示了后期强力词组的可能性。
- **知识驱动探索**: 为了解开某个石板，玩家会更有目的地去探索世界，寻找能解开其他简单石板的区域，以获取更多的基础符文。
- **回归与征服**: 当玩家通过其他途径学会了破解谜题所需的符文后，可以回到之前无法解开的石板处。成功解谜的时刻，玩家获得的不仅是新的符文，更是一种"我变强了，我用知识征服了过去无法逾越的障碍"的巨大满足感。

**4. 万能符文 (Universal Rune)**

- 存在一种极其稀有的"**空白符文**"，可以充当任何符文词组中的任意一个字。
- **获取方式**: 作为终极奖励，例如完成某个史诗级任务线、击败最终隐藏Boss或首次通关游戏。
- **定位**: 它是对玩家的终极认可，也是盘活最复杂、最顶级符文词组的关键道具。

---

## 四、三系统联动

三个子系统并非孤立存在，而是相互影响、相互增强。

```
┌─────────────────────────────────────────────────────────┐
│                     符文填字谜系统                        │
│  (提供全局被动加成，影响钉盘和子弹的基础属性)              │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│                      钉盘养成系统                         │
│  (决定弹珠能获得哪些属性层数，是Build的"输入端")          │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│                      子弹编程系统                         │
│  (将属性层数转化为实际战斗效果，是Build的"输出端")        │
└─────────────────────────────────────────────────────────┘
```

**联动示例**：

1. 玩家在**符文格**中组成"烈焰"词组，获得"火属性伤害 +20%"的被动。
2. 玩家在**钉盘**中安装多个"火焰钉"，确保弹珠能获得大量火属性层数。
3. 弹珠在钉盘中弹跳，撞击火焰钉，为子弹叠加火属性层数。
4. **子弹**射出，携带高层数的火属性，配合符文的加成，造成巨额燃烧伤害。

---

## 五、开放问题与下一步

1. **数值框架**: 各系统的数值如何平衡？属性层数与最终伤害的换算公式？
2. **获取节奏**: 钉子、符文的获取节奏如何设计，才能让玩家感受到持续的成长？
3. **信息呈现**: 如何向玩家清晰地展示这套复杂系统的状态和效果？
4. **新手引导**: 如何分阶段引入这三个系统，避免信息过载？
